\hypertarget{algo__rohsa_8hpp_source}{}\doxysection{algo\+\_\+rohsa.\+hpp}
\label{algo__rohsa_8hpp_source}\index{inc/algo\_rohsa.hpp@{inc/algo\_rohsa.hpp}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001 \textcolor{preprocessor}{\#ifndef DEF\_ALGO\_ROHSA}}
\DoxyCodeLine{00002 \textcolor{preprocessor}{\#define DEF\_ALGO\_ROHSA}}
\DoxyCodeLine{00003 }
\DoxyCodeLine{00004 \textcolor{comment}{//\#include "../lbfgsb-\/gpu/culbfgsb/culbfgsb.h"}}
\DoxyCodeLine{00005 \textcolor{preprocessor}{\#include "../L-\/BFGS-\/B-\/C/src/lbfgsb.h"}}
\DoxyCodeLine{00006 \textcolor{preprocessor}{\#include "hypercube.hpp"}}
\DoxyCodeLine{00007 \textcolor{preprocessor}{\#include "parameters.hpp"}}
\DoxyCodeLine{00008 \textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{00009 \textcolor{preprocessor}{\#include <stdio.h>}}
\DoxyCodeLine{00010 \textcolor{preprocessor}{\#include <cmath>}}
\DoxyCodeLine{00011 \textcolor{comment}{//\#include <math.h>}}
\DoxyCodeLine{00012 \textcolor{preprocessor}{\#include <string>}}
\DoxyCodeLine{00013 \textcolor{preprocessor}{\#include <fstream>}}
\DoxyCodeLine{00014 \textcolor{preprocessor}{\#include <valarray>}}
\DoxyCodeLine{00015 \textcolor{preprocessor}{\#include <CCfits/CCfits>}}
\DoxyCodeLine{00016 \textcolor{preprocessor}{\#include <vector>}}
\DoxyCodeLine{00017 \textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{00018 }
\DoxyCodeLine{00019 }
\DoxyCodeLine{00039 \textcolor{comment}{// mettre des const à la fin des déclarations si on ne modifie pas l'objet / les attributs}}
\DoxyCodeLine{00040 }
\DoxyCodeLine{00044 }
\DoxyCodeLine{00045 }
\DoxyCodeLine{\Hypertarget{algo__rohsa_8hpp_source_l00046}\mbox{\hyperlink{classalgo__rohsa}{00046}} \textcolor{keyword}{class }\mbox{\hyperlink{classalgo__rohsa}{algo\_rohsa}}}
\DoxyCodeLine{00047 \{}
\DoxyCodeLine{00048     \textcolor{keyword}{public}:}
\DoxyCodeLine{00049 }
\DoxyCodeLine{00050     \mbox{\hyperlink{classalgo__rohsa}{algo\_rohsa}}(\mbox{\hyperlink{classparameters}{parameters}} \&M, \mbox{\hyperlink{classhypercube}{hypercube}} \&Hypercube); \textcolor{comment}{//constructeur}}
\DoxyCodeLine{00051 }
\DoxyCodeLine{00052     \textcolor{keywordtype}{void} descente(\mbox{\hyperlink{classparameters}{parameters}} \&M, std::vector<std::vector<std::vector<double>>> \&grid\_params, std::vector<std::vector<std::vector<double>>> \&fit\_params); \textcolor{comment}{//effectue la descente et/ou la régularisation}}
\DoxyCodeLine{00053     \textcolor{keywordtype}{void} descente\_sans\_regu(\mbox{\hyperlink{classparameters}{parameters}} \&M, std::vector<std::vector<std::vector<double>>> \&grid\_params, std::vector<std::vector<std::vector<double>>> \&fit\_params); \textcolor{comment}{//effectue la descente et/ou la régularisation}}
\DoxyCodeLine{00054 }
\DoxyCodeLine{00055 \textcolor{comment}{//  Computationnal tools}}
\DoxyCodeLine{00056     \textcolor{keywordtype}{void} convolution\_2D\_mirror(\textcolor{keyword}{const} \mbox{\hyperlink{classparameters}{parameters}} \&M, \textcolor{keyword}{const} std::vector<std::vector<double>> \&image, std::vector<std::vector<double>> \&conv, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x, \textcolor{keywordtype}{int} dim\_k); \textcolor{comment}{//convolution 2D}}
\DoxyCodeLine{00057     \textcolor{keywordtype}{void} convolution\_2D\_mirror\_flat(\textcolor{keyword}{const} \mbox{\hyperlink{classparameters}{parameters}} \&M, \textcolor{keywordtype}{double}* image, \textcolor{keywordtype}{double}* \&conv, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x, \textcolor{keywordtype}{int} dim\_k);}
\DoxyCodeLine{00058     \textcolor{keywordtype}{void} convolution\_2D\_mirror\_flat(\textcolor{keyword}{const} \mbox{\hyperlink{classparameters}{parameters}} \&M, \textcolor{keywordtype}{float}* image, \textcolor{keywordtype}{float}* \&conv, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x, \textcolor{keywordtype}{int} dim\_k, \textcolor{keywordtype}{float} temps\_transfert, \textcolor{keywordtype}{float} temps\_mirroirs);}
\DoxyCodeLine{00059 }
\DoxyCodeLine{00060     \textcolor{keywordtype}{void} ravel\_2D(\textcolor{keyword}{const} std::vector<std::vector<double>> \&map, std::vector<double> \&vector, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00061     \textcolor{keywordtype}{void} ravel\_3D(\textcolor{keyword}{const} std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} vector[], \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00062     \textcolor{keywordtype}{void} ravel\_3D(\textcolor{keyword}{const} std::vector<std::vector<std::vector<double>>> \&cube, std::vector<double> \&vector, \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00063     \textcolor{keywordtype}{void} ravel\_3D\_bis(\textcolor{keyword}{const} std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} vector[], \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00064     \textcolor{keywordtype}{void} ravel\_3D\_abs(\textcolor{keyword}{const} std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keyword}{const} std::vector<std::vector<std::vector<double>>> \&cube\_abs, std::vector<double> \&vector, \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00065     \textcolor{keywordtype}{void} unravel\_3D(\textcolor{keyword}{const} std::vector<double> \&vector, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00066     \textcolor{keywordtype}{void} unravel\_3D(\textcolor{keywordtype}{double} vector[], std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00067     \textcolor{keywordtype}{void} unravel\_3D\_with\_formula\_transpose\_xy(\textcolor{keywordtype}{double} vector[], std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00068     \textcolor{keywordtype}{void} unravel\_3D\_T(\textcolor{keywordtype}{double} vector[], std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00069     \textcolor{keywordtype}{void} unravel\_3D\_abs(\textcolor{keyword}{const} std::vector<double> \&vector, std::vector<std::vector<std::vector<double>>> \&cube\_abs,std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00070     \textcolor{keywordtype}{double} Std(\textcolor{keyword}{const} std::vector<double> \&array);}
\DoxyCodeLine{00071     \textcolor{keywordtype}{double} mean(\textcolor{keyword}{const} std::vector<double> \&array);}
\DoxyCodeLine{00072     \textcolor{keywordtype}{double} std\_2D(\textcolor{keyword}{const} std::vector<std::vector<double>> \&map, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00073     \textcolor{keywordtype}{double} max\_2D(\textcolor{keyword}{const} std::vector<std::vector<double>> \&map, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00074     \textcolor{keywordtype}{double} mean\_2D(\textcolor{keyword}{const} std::vector<std::vector<double>> \&map, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_x);}
\DoxyCodeLine{00075     \textcolor{keywordtype}{void} std\_spectrum(\textcolor{keywordtype}{int} dim\_x, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_v);}
\DoxyCodeLine{00076     \textcolor{keywordtype}{void} mean\_spectrum(\textcolor{keywordtype}{int} dim\_x, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_v);}
\DoxyCodeLine{00077     \textcolor{keywordtype}{void} max\_spectrum(\textcolor{keywordtype}{int} dim\_x, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_v);}
\DoxyCodeLine{00078     \textcolor{keywordtype}{void} max\_spectrum\_norm(\textcolor{keywordtype}{int} dim\_x, \textcolor{keywordtype}{int} dim\_y, \textcolor{keywordtype}{int} dim\_v, \textcolor{keywordtype}{double} norm\_value);}
\DoxyCodeLine{00079     \textcolor{keywordtype}{void} init\_bounds(\mbox{\hyperlink{classparameters}{parameters}} \&M, std::vector<double> line, \textcolor{keywordtype}{int} n\_gauss\_local, std::vector<double> \&lb, std::vector<double> \&ub, \textcolor{keywordtype}{bool} \_init); \textcolor{comment}{// Conditions aux bord du spectre}}
\DoxyCodeLine{00080 }
\DoxyCodeLine{00081     \textcolor{keywordtype}{void} mean\_array(\textcolor{keywordtype}{int} power, std::vector<std::vector<std::vector<double>>> \&mean\_array\_); \textcolor{comment}{//moyenne du tableau}}
\DoxyCodeLine{00082 }
\DoxyCodeLine{00083     \textcolor{keywordtype}{void} init\_spectrum(\mbox{\hyperlink{classparameters}{parameters}} \&M, std::vector<double> \&line, std::vector<double> \&params); }
\DoxyCodeLine{00084     \textcolor{comment}{//init spectre descente}}
\DoxyCodeLine{00085     \textcolor{keywordtype}{double} model\_function(\textcolor{keywordtype}{int} x, \textcolor{keywordtype}{double} a, \textcolor{keywordtype}{double} m, \textcolor{keywordtype}{double} s); \textcolor{comment}{//modèle}}
\DoxyCodeLine{00086 }
\DoxyCodeLine{00087     \textcolor{keywordtype}{int} minloc(std::vector<double> \&tab); \textcolor{comment}{//argmin}}
\DoxyCodeLine{00088 }
\DoxyCodeLine{00089     \textcolor{keywordtype}{void} minimize\_spec(\mbox{\hyperlink{classparameters}{parameters}} \&M, \textcolor{keywordtype}{long} n, \textcolor{keywordtype}{long} m, std::vector<double> \&x\_v, std::vector<double> \&lb\_v, \textcolor{keywordtype}{int} n\_gauss\_i,std::vector<double> \&ub\_v, std::vector<double> \&line\_v); \textcolor{comment}{//LBFGS}}
\DoxyCodeLine{00090 }
\DoxyCodeLine{00091      \textcolor{keywordtype}{void} minimize(\mbox{\hyperlink{classparameters}{parameters}} \&M, \textcolor{keywordtype}{long} n, \textcolor{keywordtype}{long} m, std::vector<double> \&x\_v, std::vector<double> \&lb\_v, std::vector<double> \&ub\_v, std::vector<std::vector<std::vector<double>>> \&cube, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig, \textcolor{keywordtype}{int} indice\_x, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{double}* cube\_flattened);}
\DoxyCodeLine{00092 }
\DoxyCodeLine{00093     \textcolor{keywordtype}{void} myresidual(\textcolor{keywordtype}{double} params[], \textcolor{keywordtype}{double} line[], std::vector<double> \&residual, \textcolor{keywordtype}{int} n\_gauss\_i);}
\DoxyCodeLine{00094     \textcolor{keywordtype}{void} myresidual(std::vector<double> \&params, std::vector<double> \&line, std::vector<double> \&residual, \textcolor{keywordtype}{int} n\_gauss\_i);}
\DoxyCodeLine{00095 }
\DoxyCodeLine{00096     \textcolor{keywordtype}{void} tab\_from\_1Dvector\_to\_double(std::vector<double> vect);}
\DoxyCodeLine{00097     \textcolor{keywordtype}{double} myfunc\_spec(std::vector<double> \&residual);}
\DoxyCodeLine{00098 }
\DoxyCodeLine{00099     \textcolor{keywordtype}{void} mygrad\_spec(\textcolor{keywordtype}{double} gradient[], std::vector<double> \&residual, \textcolor{keywordtype}{double} params[], \textcolor{keywordtype}{int} n\_gauss\_i);}
\DoxyCodeLine{00100 }
\DoxyCodeLine{00101     \textcolor{keywordtype}{void} upgrade(\mbox{\hyperlink{classparameters}{parameters}} \&M, std::vector<std::vector<std::vector<double>>> \&cube, std::vector<std::vector<std::vector<double>>> \&params, \textcolor{keywordtype}{int} power);}
\DoxyCodeLine{00102 }
\DoxyCodeLine{00103     \textcolor{keywordtype}{void} go\_up\_level(std::vector<std::vector<std::vector<double>>> \&fit\_params);}
\DoxyCodeLine{00104 }
\DoxyCodeLine{00105     \textcolor{keywordtype}{void} set\_stdmap(std::vector<std::vector<double>> \&std\_map, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{int} lb, \textcolor{keywordtype}{int} ub);}
\DoxyCodeLine{00106     \textcolor{keywordtype}{void} set\_stdmap\_transpose(std::vector<std::vector<double>> \&std\_map, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{int} lb, \textcolor{keywordtype}{int} ub);}
\DoxyCodeLine{00107     \textcolor{keywordtype}{void} update(\mbox{\hyperlink{classparameters}{parameters}} \&M, std::vector<std::vector<std::vector<double>>> \&cube, std::vector<std::vector<std::vector<double>>> \&params, std::vector<std::vector<double>> \&std\_map, \textcolor{keywordtype}{int} indice\_x, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_v,std::vector<double> \&b\_params);}
\DoxyCodeLine{00108 }
\DoxyCodeLine{00109     \textcolor{keywordtype}{void} f\_g\_cube\_vector(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00110     \textcolor{keywordtype}{void} f\_g\_cube\_old\_archive(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00111     \textcolor{keywordtype}{void} f\_g\_cube\_sep(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00112     \textcolor{keywordtype}{void} f\_g\_cube\_test(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00113     \textcolor{keywordtype}{void} f\_g\_cube\_naive(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00114     \textcolor{keywordtype}{void} f\_g\_cube\_fast(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00115     \textcolor{keywordtype}{void} f\_g\_cube\_fast\_without\_regul(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00116     \textcolor{keywordtype}{void} f\_g\_cube\_cuda\_L(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig, \textcolor{keywordtype}{double}* cube\_flattened);}
\DoxyCodeLine{00117 }
\DoxyCodeLine{00118     \textcolor{comment}{//GPU sur les 2/3 de f\_g\_cube, utilise params\_flat au lieu de travailler avec beta}}
\DoxyCodeLine{00119     \textcolor{keywordtype}{void} f\_g\_cube\_cuda\_L\_deux\_tiers(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig, \textcolor{keywordtype}{double}* cube\_flattened);}
\DoxyCodeLine{00120 }
\DoxyCodeLine{00121     \textcolor{keywordtype}{void} f\_g\_cube\_cuda\_L\_debug(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00122     \textcolor{keywordtype}{void} f\_g\_cube\_cuda\_L\_2(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00123 \textcolor{comment}{//  void f\_g\_cube\_cuda\_L\_3(parameters \&M,double \&f, double g[],  int n, std::vector<std::vector<std::vector<double>>> \&cube, double beta[], int indice\_v, int indice\_y, int indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}}
\DoxyCodeLine{00124     \textcolor{keywordtype}{void} f\_g\_cube\_cuda\_L\_2\_2Bverified(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00125     \textcolor{keywordtype}{void} f\_g\_cube\_omp(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00126     \textcolor{keywordtype}{void} f\_g\_cube\_omp\_without\_regul(\mbox{\hyperlink{classparameters}{parameters}} \&M,\textcolor{keywordtype}{double} \&f, \textcolor{keywordtype}{double} g[],  \textcolor{keywordtype}{int} n, std::vector<std::vector<std::vector<double>>> \&cube, \textcolor{keywordtype}{double} beta[], \textcolor{keywordtype}{int} indice\_v, \textcolor{keywordtype}{int} indice\_y, \textcolor{keywordtype}{int} indice\_x, std::vector<std::vector<double>> \&std\_map, std::vector<double> \&mean\_amp, std::vector<double> \&mean\_mu, std::vector<double> \&mean\_sig);}
\DoxyCodeLine{00127 }
\DoxyCodeLine{00128     \textcolor{keywordtype}{void} reshape\_down(std::vector<std::vector<std::vector<double>>> \&tab1, std::vector<std::vector<std::vector<double>>>\&tab2);}
\DoxyCodeLine{00129 }
\DoxyCodeLine{00130     \textcolor{keywordtype}{void} mean\_parameters(std::vector<std::vector<std::vector<double>>> \&params);}
\DoxyCodeLine{00131 }
\DoxyCodeLine{00132 }
\DoxyCodeLine{00133     std::vector<std::vector<std::vector<double>>> grid\_params;}
\DoxyCodeLine{00134     std::vector<std::vector<std::vector<double>>> fit\_params;}
\DoxyCodeLine{00135 }
\DoxyCodeLine{00136     \textcolor{keywordtype}{double}* cube\_or\_dat\_flattened;}
\DoxyCodeLine{00137 }
\DoxyCodeLine{00138 \textcolor{comment}{//  Computationnal tools}}
\DoxyCodeLine{00139     \textcolor{keyword}{private}:}
\DoxyCodeLine{00140 }
\DoxyCodeLine{00141     std::vector<std::vector<double>> kernel;}
\DoxyCodeLine{00142     std::vector<int> dim\_cube; \textcolor{comment}{//}}
\DoxyCodeLine{00143     std::vector<int> dim\_data; \textcolor{comment}{//}}
\DoxyCodeLine{00144 }
\DoxyCodeLine{00145     \textcolor{keywordtype}{int} dim\_x;}
\DoxyCodeLine{00146     \textcolor{keywordtype}{int} dim\_y;}
\DoxyCodeLine{00147     \textcolor{keywordtype}{int} dim\_v;}
\DoxyCodeLine{00148     \mbox{\hyperlink{classhypercube}{hypercube}} file;}
\DoxyCodeLine{00149 }
\DoxyCodeLine{00150     \textcolor{keywordtype}{double} temps\_modification\_beta;}
\DoxyCodeLine{00151     \textcolor{keywordtype}{double} temps\_f\_g\_cube;}
\DoxyCodeLine{00152     \textcolor{keywordtype}{double} temps\_conv;}
\DoxyCodeLine{00153     \textcolor{keywordtype}{double} temps\_deriv;}
\DoxyCodeLine{00154     \textcolor{keywordtype}{double} temps\_tableaux;}
\DoxyCodeLine{00155     \textcolor{keywordtype}{double} temps\_bfgs;}
\DoxyCodeLine{00156     \textcolor{keywordtype}{double} temps\_update\_beginning;}
\DoxyCodeLine{00157     \textcolor{keywordtype}{double} temps\_;}
\DoxyCodeLine{00158     \textcolor{keywordtype}{double} temps\_f\_g\_cube\_tot;}
\DoxyCodeLine{00159     \textcolor{keywordtype}{double} temps\_1\_tot;}
\DoxyCodeLine{00160     \textcolor{keywordtype}{double} temps\_2\_tot;}
\DoxyCodeLine{00161     \textcolor{keywordtype}{double} temps\_3\_tot;}
\DoxyCodeLine{00162     \textcolor{keywordtype}{double} temps\_ravel;}
\DoxyCodeLine{00163     \textcolor{keywordtype}{double} temps\_tableau\_update;}
\DoxyCodeLine{00164     \textcolor{keywordtype}{double} temps\_setulb;}
\DoxyCodeLine{00165 }
\DoxyCodeLine{00166     \textcolor{keywordtype}{float} temps\_transfert;}
\DoxyCodeLine{00167     \textcolor{keywordtype}{float} temps\_mirroirs;}
\DoxyCodeLine{00168     }
\DoxyCodeLine{00169 }
\DoxyCodeLine{00170     \textcolor{keywordtype}{int} n\_gauss\_add; \textcolor{comment}{//EN DISCUTER AVEC ANTOINE}}
\DoxyCodeLine{00171 }
\DoxyCodeLine{00172     std::vector<double> std\_spect, mean\_spect, max\_spect, max\_spect\_norm;}
\DoxyCodeLine{00173     }
\DoxyCodeLine{00174     }
\DoxyCodeLine{00175 }
\DoxyCodeLine{00176 \textcolor{comment}{/*}}
\DoxyCodeLine{00177 \textcolor{comment}{    int n\_gauss\_add;}}
\DoxyCodeLine{00178 \textcolor{comment}{    int nside;}}
\DoxyCodeLine{00179 \textcolor{comment}{    int n;}}
\DoxyCodeLine{00180 \textcolor{comment}{    int power;}}
\DoxyCodeLine{00181 \textcolor{comment}{    double ub\_sig\_init;}}
\DoxyCodeLine{00182 \textcolor{comment}{    double ub\_sig;}}
\DoxyCodeLine{00183 \textcolor{comment}{}}
\DoxyCodeLine{00184 \textcolor{comment}{    std::vector<int> dim\_data;}}
\DoxyCodeLine{00185 \textcolor{comment}{    std::vector<int> dim\_cube; }}
\DoxyCodeLine{00186 \textcolor{comment}{}}
\DoxyCodeLine{00187 \textcolor{comment}{*/}}
\DoxyCodeLine{00188 }
\DoxyCodeLine{00189 \};}
\DoxyCodeLine{00190 }
\DoxyCodeLine{00191 }
\DoxyCodeLine{00192 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
